/*! RetroPhone v1.0.0 - 2014-08-09 
 *  Copyright: Peter Szerzo, 2014 */


function circle(a,b,c){RPH.ctx.beginPath(),RPH.ctx.arc(a,b,c,0,2*Math.PI,!0),RPH.ctx.fill()}function rect(a,b,c,d){RPH.ctx.beginPath(),RPH.ctx.rect(a,b,c,d),RPH.ctx.closePath(),RPH.ctx.fill()}function clear(){RPH.ctx.clearRect(0,0,W,H)}function getDistance(a,b,c,d){return Math.pow(Math.pow(a-c,2)+Math.pow(b-d,2),.5)}function getAngle(a,b,c,d){var e;return Math.abs(a-c)<W/100&&d>b?1*Math.PI/2:Math.abs(a-c)<W/100&&b>d?3*Math.PI/2:(e=Math.atan((d-b)/(c-a)),c>a?0>e?e+2*Math.PI:e:e+Math.PI)}function draw(){var a,b;for(clear(),RPH.ctx.textAlign="center",RPH.ctx.textBaseline="middle",RPH.phone.drawRing(),RPH.phone.drawLine(),RPH.phone.drawNumber(),RPH.ctx.lineWidth=0,alpha>0&&!RPH.mouse.isDragging&&(alpha-=.02),RPH.ctx.font=minWH/18+"px Courier",b=0;10>b;b+=1)RPH.ctx.fillStyle=digit===b?"rgb(180,205,200)":"rgb(240,245,240)",a=oBeta+dBeta*b+alpha,circle(W*xc+minWH*r1*Math.cos(a),H*yc+minWH*r1*Math.sin(a),minWH*r3),RPH.ctx.fillStyle="#444444",a=oBeta+dBeta*b,RPH.ctx.fillText(b,W*xc+minWH*r1*Math.cos(a),H*yc+minWH*r1*Math.sin(a));RPH.canvas.addEventListener("mousedown",RPH.mouseDown),RPH.canvas.addEventListener("mousemove",RPH.mouseMove),RPH.canvas.addEventListener("mouseup",RPH.mouseUp)}function touchHandler(a){var b=a.changedTouches[0],c=document.createEvent("MouseEvent");c.initMouseEvent({touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup"}[a.type],!0,!0,window,1,b.screenX,b.screenY,b.clientX,b.clientY,!1,!1,!1,!1,0,null),b.target.dispatchEvent(c),a.preventDefault()}var RPH={},valid=!0,digit=-1;RPH.dialer={number:"",dial:function(){window.location="tel:"+this.number}},RPH.mouse={x:0,y:0,xDrag:0,yDrag:0,isDragging:!1,get:function(a){var b=RPH.canvas.getBoundingClientRect();this.x=a.clientX-b.left,this.y=a.clientY-b.top},down:function(a){this.get(a),this.xDrag=this.x,this.yDrag=this.y,this.isDragging=!0},up:function(a){this.get(a),this.isDragging=!1},move:function(a){this.get(a)}};var W,H,minWH;RPH.phone={alpha:0,alphaPrev:0,oBeta:4*Math.PI/9,dBeta:Math.PI/7,rBeta:Math.PI/24,r0:.35,r2:.23,r1:.29,r3:4,fontString:"",activeDigit:-1,drawRing:function(){var a=this.centroid.x,b=this.centroid.y;RPH.ctx.fillStyle="#444444",circle(W*a,H*b,minWH*this.r0),RPH.ctx.fillStyle="rgb(240,245,240)",circle(W*a,H*b,minWH*this.r2)},drawLine:function(){var a=this.oBeta+10*dBeta+rBeta,b=this.centroid.x,c=this.centroid.y;RPH.ctx.strokeStyle="rgb(240,245,240)",RPH.ctx.beginPath(),RPH.ctx.moveTo(W*b+this.r0*minWH*Math.cos(a),H*c+this.r0*minWH*Math.sin(a)),RPH.ctx.lineTo(W*b+this.r1*minWH*Math.cos(a),H*c+this.r1*minWH*Math.sin(a)),RPH.ctx.lineWidth=minWH/150,RPH.ctx.stroke()},drawNumber:function(){RPH.ctx.font=this.fontString,RPH.ctx.fillStyle="#444444",RPH.ctx.fillText(RPH.dialer.number,W*xText,H*yText)},centroid:{x:.5,y:.55},xc:.5,yc:.55,text:{x:.5,y:.1,isHovered:function(){return RPH.mouse.y/minWH<this.y+.02&&RPH.mouse.y/minWH>this.y-.02}}};var alpha=0,alphaPrev=0,oBeta=4*Math.PI/9,dBeta=Math.PI/7,rBeta=Math.PI/24,r0=.35,r2=.23,r1=(r0+r2)/2,r3=(r0-r2)/3,xc=.5,yc=.55,xText=.5,yText=.1;RPH.mouseUp=function(){RPH.mouse.up()},RPH.mouseDown=function(a){RPH.mouse.down(a),RPH.mouse.isDragging=.03>alpha&&-1!==digit,RPH.phone.text.isHovered()&&RPH.dialer.dial()},RPH.mouseMove=function(a){if(RPH.mouse.move(a),RPH.mouse.isDragging&&(alpha=getAngle(W*xc,H*yc,RPH.mouse.x,RPH.mouse.y)-getAngle(W*xc,H*yc,RPH.mouse.xDrag,RPH.mouse.yDrag),alpha=0>alpha?0:alpha,alpha>(10-digit)*dBeta+rBeta&&(RPH.mouse.isDragging=!1,RPH.dialer.number.length<12&&(RPH.dialer.number+=digit),(3===RPH.dialer.number.length||7===RPH.dialer.number.length)&&(RPH.dialer.number+="-"),digit=-1)),.03>alpha){for(var b=-1,c=0;10>c;c+=1){angle=oBeta+dBeta*c+alpha;var d=W*xc+minWH*r1*Math.cos(angle),e=H*yc+minWH*r1*Math.sin(angle);getDistance(RPH.mouse.x,RPH.mouse.y,d,e)<minWH*r3&&(b=c)}digit=b}RPH.fontString=RPH.phone.text.isHovered()?"bold ":"",RPH.fontString+=minWH/30+"px Courier"},RPH.mouseUp=function(a){RPH.mouse.up(a)},RPH.init=function(){return document.addEventListener("touchstart",touchHandler,!0),document.addEventListener("touchmove",touchHandler,!0),document.addEventListener("touchend",touchHandler,!0),document.addEventListener("touchcancel",touchHandler,!0),RPH.canvas=document.getElementById("retrophone"),RPH.ctx=RPH.canvas.getContext("2d"),this.resizeCanvas(),setInterval(draw,10)},RPH.resizeCanvas=function(){RPH.canvas.width=window.innerWidth,RPH.canvas.height=window.innerHeight,W=RPH.canvas.width,H=RPH.canvas.height,minWH=Math.min(W,H)},RPH.init(),window.addEventListener("resize",RPH.resizeCanvas,!1);
//# sourceMappingURL=RetroPhone-v1.0.0.min.js.map